{% extends 'base.html' %}
{% load static %}

{% block css %}
<link rel="stylesheet" href="{% static 'style.css' %}">
{% endblock %}

{% block content %}
<h2>Live Weather Data</h2>
<p>Temperature: <span id="temp">Loading...</span> Â°C</p>
<p>Humidity: <span id="humidity">Loading...</span> %</p>

<script>
    function fetchWeatherData() {
        fetch('/gsm/receive-data/')  // Correct endpoint
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    document.getElementById("temp").innerText = data.data.temperature;
                    document.getElementById("humidity").innerText = data.data.humidity;
                }
            })
            .catch(error => console.error('Error fetching data:', error));
    }

    // Fetch data every 5 seconds
    setInterval(fetchWeatherData, 5000);

    // Fetch initially on page load
    fetchWeatherData();
</script>
{% endblock %}